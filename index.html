<!DOCTYPE html>

<html lang="pl">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>JeppCMPR v2.5.0 - PDF Comparison Tool</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<link href="css/style.css" rel="stylesheet"/>
</head>
<body>
<div class="container">
<div class="header">
<h1>✈️ JeppCMPR</h1>
<p>Professional PDF Comparison Tool with Advanced Frame Alignment</p>
<div class="version-badge">v2.5.0 - Manual Alignment</div>
</div>
<div class="upload-section" id="uploadSection">
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 20px;">
<div>
<div class="drop-zone" id="dropZoneOld" style="border-color: #dc3545;">
<div class="drop-zone-icon">📥</div>
<div class="drop-zone-text" style="color: #dc3545;">Przeciągnij pliki OLD tutaj</div>
<div class="drop-zone-hint">lub użyj przycisku poniżej</div>
</div>
<button class="btn btn-primary" onclick="loadOldFolder()" style="width: 100%; margin-top: 15px; background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);">
                        📂 Wybierz pliki OLD
                    </button>
<div id="oldFilesCount" style="margin-top: 10px; text-align: center; color: #ccc;">Nie załadowano</div>
</div>
<div>
<div class="drop-zone" id="dropZoneNew" style="border-color: #28a745;">
<div class="drop-zone-icon">📥</div>
<div class="drop-zone-text" style="color: #28a745;">Przeciągnij pliki NEW tutaj</div>
<div class="drop-zone-hint">lub użyj przycisku poniżej</div>
</div>
<button class="btn btn-primary" onclick="loadNewFolder()" style="width: 100%; margin-top: 15px; background: linear-gradient(135deg, #28a745 0%, #218838 100%);">
                        📂 Wybierz pliki NEW
                    </button>
<div id="newFilesCount" style="margin-top: 10px; text-align: center; color: #ccc;">Nie załadowano</div>
</div>
</div>
<div id="compareButtonContainer" style="text-align: center; display: none;">
<button class="btn btn-primary" onclick="startComparison()" style="padding: 20px 50px; font-size: 1.3em;">
                    🚀 Rozpocznij porównanie
                </button>
</div>
<!-- Quality Selector -->
<div class="quality-selector">
<h3>⚙️ Jakość renderowania PDF</h3>
<div class="quality-options">
<div class="quality-option" onclick="selectQuality('low')">
<input id="quality-low" name="quality" type="radio" value="low"/>
<label for="quality-low">Niska</label>
<div class="quality-scale">Scale: 1.5</div>
<div class="quality-scale">Szybkie ładowanie</div>
</div>
<div class="quality-option selected" onclick="selectQuality('standard')">
<input checked="" id="quality-standard" name="quality" type="radio" value="standard"/>
<label for="quality-standard">Standardowa</label>
<div class="quality-scale">Scale: 3.0</div>
<div class="quality-scale">Balans jakość/szybkość</div>
</div>
<div class="quality-option" onclick="selectQuality('high')">
<input id="quality-high" name="quality" type="radio" value="high"/>
<label for="quality-high">Wysoka</label>
<div class="quality-scale">Scale: 4.5</div>
<div class="quality-scale">Najlepsza jakość</div>
</div>
</div>
</div>
<input accept=".pdf" class="file-input" id="oldFileInput" multiple="" type="file"/>
<input accept=".pdf" class="file-input" id="newFileInput" multiple="" type="file"/>
</div>
<div class="loading" id="loading">
<div class="spinner"></div>
<p id="loadingText">Ładowanie i przetwarzanie plików PDF...</p>
<div style="width: 80%; max-width: 600px; margin: 20px auto; background: #f0f0f0; border-radius: 10px; overflow: hidden;">
<div id="progressBar" style="height: 30px; background: rgba(0, 86, 214, 0.9); width: 0%; transition: width 0.3s ease; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                    0%
                </div>
</div>
<p id="progressDetail" style="color: #ccc; font-size: 0.9em;">Przygotowanie...</p>
</div>
<div class="comparison-section" id="comparisonSection">
<div class="comparison-grid">
<!-- Left Sidebar -->
<div class="sidebar sidebar-left" id="leftSidebar">
<button class="new-comparison-btn" onclick="resetAndUpload()">🔄 Nowe porównanie</button>
<!-- Manual Pairing Zone -->
<div class="manual-pairing">
<div class="mini-dropzone old" id="dropZoneManualOld">
<div class="mini-dropzone-text">🎯 OLD</div>
<div class="mini-dropzone-file" id="manualOldFile">przeciągnij tutaj</div>
<div class="mini-dropzone-count" id="manualOldCount"></div>
</div>
<div class="mini-dropzone new" id="dropZoneManualNew">
<div class="mini-dropzone-text">🎯 NEW</div>
<div class="mini-dropzone-file" id="manualNewFile">przeciągnij tutaj</div>
<div class="mini-dropzone-count" id="manualNewCount"></div>
</div>
</div>
<button class="create-pair-btn" disabled="" id="createPairBtn" onclick="createManualPair()">
                        ➕ Utwórz parę
                    </button>
<div class="sidebar-scroll" id="pairListSidebar"></div>
<div class="jad-generator">
<div class="jad-header">📋 JAD Project Name</div>
<div class="jad-control">
<label>ASSET:</label>
<select id="jadAsset" onchange="updateJADCode()">
<option value="SAQ">SAQ</option>
<option selected="" value="DET">DET</option>
<option value="APP">APP</option>
<option value="SIDSTAR">SIDSTAR</option>
<option value="ENR">ENR</option>
</select>
</div>
<div class="jad-label">Proponowana nazwa projektu:</div>
<div class="jad-code-container">
<div class="jad-code" id="jadCode">-</div>
<button class="jad-copy-btn" onclick="copyJADCode()" title="Kopiuj do schowka">📋</button>
</div>
</div>
</div>
<!-- Left Resizer -->
<div class="resizer" id="leftResizer"></div>
<!-- Main Content -->
<div class="main-content" id="mainContent">
<div class="page-nav" id="pageNav" style="display: none;">
<button onclick="prevPage()">⬅️ Poprzednia</button>
<div class="page-info" id="pageInfo">Strona 1 z 1</div>
<button onclick="nextPage()">Następna ➡️</button>
</div>
<div class="viewer-wrapper" id="viewerWrapper">
<div id="viewer"></div>
<div class="canvas-label" id="canvasLabel" style="display: none;"></div>
<!-- Dedykowany canvas dla Pixel Diff -->
<canvas class="pixel-diff-overlay" id="pixelDiffOverlay"></canvas>
<div class="fullscreen-map-name" id="fullscreenMapName" style="display: none;"></div>
<div class="fullscreen-shortcuts" id="fullscreenShortcuts" style="display: none;">
<div style="font-weight: bold; margin-bottom: 5px; color: rgba(0, 86, 214, 1);">⌨️ Skróty klawiszowe:</div>
<div><kbd>Ctrl</kbd> - Zmień OLD/NEW</div>
<div><kbd>←</kbd> <kbd>→</kbd> - Poprzednia/Następna strona</div>
<div><kbd>↑</kbd> <kbd>↓</kbd> - Poprzednia/Następna mapa</div>
<div><kbd>P</kbd> - Pixel Diff ON/OFF</div>
</div>
<button class="reset-zoom-btn" id="resetZoomBtn" style="display: none;">🔄 Reset widoku</button>
<button class="fullscreen-toggle-btn" id="fullscreenToggleBtn" onclick="toggleFullscreen()" style="display: none;">🖵 Pełny ekran</button>
<button class="exit-fullscreen-btn" id="exitFullscreenBtn" onclick="toggleFullscreen()">⚙️ Wróć do opcji</button>
</div>
</div>
<!-- Right Resizer -->
<div class="resizer" id="rightResizer"></div>
<!-- Right Sidebar -->
<div class="sidebar sidebar-right" id="rightSidebar">
<div class="control-panel">
<div class="control-item">
<label>Obrót:</label>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px;">
<button class="action-btn" onclick="rotateMap(-90)">↶</button>
<button class="action-btn" onclick="rotateMap(90)">↷</button>
</div>
</div>
<div style="border-top: 2px solid #ddd; margin: 5px 0;"></div>
<div class="control-item">
<label>Jakość:</label>
<select id="qualitySelectRuntime" onchange="changeQualityRuntime()" style="width: 100%; padding: 8px; background: rgba(60, 60, 79, 0.8); color: white; border: 2px solid rgba(0, 86, 214, 0.5); border-radius: 6px; font-size: 0.93em; cursor: pointer;">
<option value="low">Niska (1.5x)</option>
<option selected="" value="standard">Standardowa (3.0x)</option>
<option value="high">Wysoka (4.5x)</option>
</select>
</div>
<div style="border-top: 2px solid #ddd; margin: 5px 0;"></div>
<div class="control-item">
<label>Tryb:</label>
<div class="mode-buttons">
<div class="mode-btn active" onclick="setMode('toggle')">🔄 Przełączanie</div>
<div class="mode-btn" onclick="setMode('overlay')">🎨 Nakładanie</div>
<div class="mode-btn" onclick="setMode('manual')">🎯 Ręczne dopasowanie</div>
</div>
</div>
<div class="control-item" id="manualAlignControls" style="display: none;">
<button class="action-btn" onclick="resetManualAlignment()" style="width: 100%; background: rgba(255, 193, 7, 0.9);">🔄 Reset do naturalnego</button>
<div style="font-size: 0.75em; color: #ccc; margin-top: 5px; line-height: 1.3;">
<strong>Instrukcja:</strong> Kliknij 4 punkty na OLD, potem 4 na NEW. Mapy zostaną dopasowane.
                            </div>
</div>
<div class="control-item">
<label>OLD ← → NEW:</label>
<input id="opacityRange" max="100" min="0" step="5" type="range" value="50"/>
<div class="value-display" id="opacityValue">50%</div>
</div>
<div class="control-item">
<div class="mode-buttons">
<div class="mode-btn" onclick="setMode('sidebyside')">↔️ Obok siebie</div>
</div>
</div>
<div style="border-top: 2px solid #ddd; margin: 5px 0;"></div>
<div class="control-item">
<label>Widok:</label>
<div class="view-control">
<button class="auto-btn" id="autoBtn" onclick="toggleAutoMode()">▶️ Auto</button>
<div class="view-buttons">
<button class="view-btn" id="oldBtn" onclick="showOldOnly()">OLD</button>
<button class="view-btn" id="newBtn" onclick="showNewOnly()">NEW</button>
</div>
</div>
</div>
<div class="control-item">
<label>Prędkość:</label>
<input id="speedRange" max="2000" min="100" step="100" type="range" value="500"/>
<div class="value-display" id="speedValue">0.5s</div>
</div>
<div style="border-top: 2px solid #ddd; margin: 5px 0;"></div>
<div class="control-item">
<label>🔍 Analiza różnic:</label>
<div class="mode-buttons">
<button class="ocr-btn" disabled="" id="ocrHybridBtn" onclick="toggleOCRMode('hybrid')">🟠 Pixel Diff</button>
</div>
</div>
<div class="control-item" id="sensitivityControl" style="display: none;">
<label>Czułość wykrywania:</label>
<input id="sensitivityRange" max="100" min="0" step="5" type="range" value="50"/>
<div class="value-display" id="sensitivityValue">50%</div>
<div style="font-size: 0.75em; color: #ccc; margin-top: 5px; line-height: 1.3;">
<strong>0%:</strong> Wykrywa WSZYSTKO (nawet drobne różnice)<br/>
<strong>50%:</strong> ✅ Zbalansowane (zalecane!)<br/>
<strong>100%:</strong> Tylko DUŻE różnice<br/>
<em>minArea = 25px (stałe)</em>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<script type="module" src="js/main.js"></script>

</html>
